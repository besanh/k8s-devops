k8s-begining:
  image:
    tag: "${IMAGE_TAG}"

  service:
    type: LoadBalancer

  vault:
    enabled: true
    secretPath: "database/creds/k8s-begining"

  env:
    - name: HOST
      value: "postgres"
    - name: PORT
      value: "5432"
    - name: DBNAME
      value: "anh_k8s_db"

  config:
    enabled: true
    files:
      config.tpl: |
        server:
          http:
            addr: 0.0.0.0:8000
            timeout: 1s
          grpc:
            addr: 0.0.0.0:9000
            timeout: 1s
        data:
          database:
            driver: pgx
            # Credentials injected via envsubst from Vault secrets
            source: postgres://${DB_USER}:${DB_PASS}@${DB_HOST}:${DB_PORT}/${DB_NAME}?sslmode=disable
          redis:
            addr: redis:6379
            read_timeout: 0.2s
            write_timeout: 0.2s
        log:
          level: debug
